---
title: "Rubyã§IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’ç¢ºèªã™ã‚‹"
emoji: "ğŸ¥¤"
type: "tech"
topics: ["ruby", "ipv6", "ipv4"]
published: false
---

ã“ã‚Œã¯[Ruby Advent Calendar 2024](https://qiita.com/advent-calendar/2024/ruby)ã®8æ—¥ç›®ã®è¨˜äº‹ã§ã™ã€‚æ›¸ã„ãŸã®ã¯æ—¥æœ¬æ™‚é–“ã®20æ—¥ã§ç©ºã„ã¦ã„ã‚‹ã‚¹ãƒ­ãƒƒãƒˆã«æ½œã‚Šè¾¼ã¾ã›ã¦ã‚‚ã‚‰ã„ã¾ã™ã€‚

ç­†è€…ã¯[PaaSãƒ—ãƒ­ãƒã‚¤ãƒ€ã®ã‚µãƒãƒ¼ãƒˆã¨ã—ã¦åƒã„ã¦ã„ã¦](https://zenn.dev/zunda/books/0f89b5da809f49)ã€ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆãªãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã©ã†ã—ã‚’æ¥ç¶šã™ã‚‹VPC Peeringã‚„VPNã®è¨­å®šã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚ä¾‹ãˆã°ã€`192.168.1.0/29`ã¨æ¥ç¶šã•ã‚Œã¦ã‚‹ã¯ãšãªã®ã«`192.168.1.15`ã¨é€šä¿¡ã§ããªã„ã®ã¯ã©ã†ã—ã¦ã‹èª¿æŸ»ã‚’ä¾é ¼ã•ã‚Œã‚‹ã“ã¨ãŒã‚ã‚Šã¾ã™ã€‚

ã“ã“ã§ã€`192.168.1.0/29`ã¯[Class Inter-Domain Routing](https://ja.wikipedia.org/wiki/Classless_Inter-Domain_Routing) (CIDR) è¨˜æ³•ã¨ã„ã†ã‚‚ã®ã§ã™ã€‚`/`ã®ã‚ã¨ã®æ•°å­—(10é€²æ•°)ã§ãƒãƒƒãƒˆãƒ¯ãƒ¼ã‚¯ã®ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹é•·ã§ã€`/`ã®å·¦å´ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®æœ€åˆã®ã€ãƒ—ãƒ¬ãƒ•ã‚£ãƒƒã‚¯ã‚¹é•·åˆ†ã®ãƒ“ãƒƒãƒˆæ•°ãŒä¸€è‡´ã™ã‚‹IPã‚¢ãƒ‰ãƒ¬ã‚¹ã®ç¯„å›²ã‚’ã‚ã‚‰ã‚ã—ã¾ã™ã€‚ã“ã®ä¾‹ã§ã¯ã€32ãƒ“ãƒƒãƒˆã®IPv4ã‚¢ãƒ‰ãƒ¬ã‚¹ã®ã†ã¡ã€æœ€åˆã®29ãƒ“ãƒƒãƒˆãŒä¸€è‡´ã™ã‚‹ã€ã¤ã¾ã‚Šæœ€å¾Œã®3ãƒ“ãƒƒãƒˆãŒä»»æ„ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã€ã¤ã¾ã‚Š`192.168.1.0`ã‹ã‚‰`192.168.1.7`ã¾ã§ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã‚’ã‚ã‚‰ã‚ã™ã“ã¨ã«ãªã‚Šã¾ã™ã€‚

ã“ã“ã¾ã§è€ƒå¯Ÿã™ã‚‹ã¨ã€`192.168.1.15`ã¨é€šä¿¡ã§ããªã„ç†ç”±ã¯ã€ã“ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ãŒã€`192.168.1.0/29`ã®IPã‚¢ãƒ‰ãƒ¬ã‚¹ç¯„å›²ã«å«ã¾ã‚Œãªã„ã“ã¨ã ã¨ã‚ã‹ã‚Šã¾ã™ã€‚

ãŒã€å³åº§ã«æ­£ç¢ºã«ã“ã“ã¾ã§ã®è€ƒå¯Ÿã‚’ã™ã‚‹ã®ã¯ãŸã„ã¸ã‚“ã§ã™ã‚ˆã­ã€‚ã“ã†ã„ã†å ´åˆã«ä¾¿åˆ©ãªã®ãŒã€Rubyã§ã™ã€‚

```ruby
$ irb
> require 'ipaddr'
> IPAddr.new("192.168.1.0/29").include?(IPAddr.new("192.168.1.15"))
=> false
```

IPv6ã‚¢ãƒ‰ãƒ¬ã‚¹ã§ã‚‚åŒæ§˜ã«ç¢ºèªã§ãã¾ã™ã€‚ã‚ã‚ŠãŒãŸã„ã€‚

```ruby
$ irb
> require 'ipaddr'
> IPAddr.new("::ffff:192.168.1.0/125").include?(IPAddr.new("::ffff:192.168.1.15"))
=> false
```
